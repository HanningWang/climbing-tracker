<view class="training-container">
  <view class="header">
    <text class="title">шонч╗ГшобхИТ</text>
    <text class="subtitle">хИ╢хоЪхТМш╖Яш╕кцВичЪДшонч╗ГшобхИТ</text>
  </view>

  <view class="tabs">
    <view class="tab {{activeTab === 'plan' ? 'active' : ''}}" bindtap="switchTab" data-tab="plan">
      <text>шонч╗ГшобхИТ</text>
    </view>
    <view class="tab {{activeTab === 'execute' ? 'active' : ''}}" bindtap="switchTab" data-tab="execute">
      <text>цЙзшбМшонч╗Г</text>
    </view>
  </view>

  <!-- шонч╗ГшобхИТ Tab -->
  <view class="tab-content" wx:if="{{activeTab === 'plan'}}">
    <view class="form-container">
      <view class="form-title">хИЫх╗║шонч╗ГшобхИТ</view>
      
      <view class="form-item">
        <text class="label">шобхИТхРНчз░</text>
        <input class="input" placeholder="ф╛ЛхжВя╝ЪхКЫщЗПшонч╗ГуАБшАРхКЫшонч╗Г" model:value="{{planName}}" />
      </view>

      <view class="form-item">
        <text class="label">шобхИТцЧ╢щХ┐я╝ИхИЖщТЯя╝Й</text>
        <input class="input" type="number" placeholder="ш╛УхЕешонч╗ГцЧ╢щХ┐" model:value="{{planDuration}}" />
      </view>

      <view class="form-item">
        <text class="label">шонч╗Гщб╣чЫо</text>
        <view class="exercise-input-container">
          <input class="input exercise-input" placeholder="ц╖╗хКашонч╗Гщб╣чЫо" model:value="{{exerciseInput}}" />
          <view class="add-btn" bindtap="addExercise">
            <text>+</text>
          </view>
        </view>
      </view>

      <!-- х╖▓ц╖╗хКачЪДшонч╗Гщб╣чЫохИЧшби -->
      <view class="exercises-list" wx:if="{{exercises.length > 0}}">
        <view class="exercise-item" wx:for="{{exercises}}" wx:key="index">
          <text>{{item}}</text>
          <view class="exercise-actions">
            <!-- ч╝Цш╛СхЫ╛цаЗ -->
            <view class="edit-exercise" bindtap="editExercise" data-index="{{index}}">
              <text class="edit-text">тЬО</text>
            </view>
            <!-- хИащЩдхЫ╛цаЗ -->
            <view class="delete-exercise" bindtap="deleteExercise" data-index="{{index}}">
              <text>├Ч</text>
            </view>
          </view>
        </view>
      </view>

      <button class="submit-btn" bindtap="createPlan">хИЫх╗║шобхИТ</button>
    </view>

    <!-- х╖▓ф┐ЭхнШчЪДшонч╗ГшобхИТхИЧшби -->
    <view class="plans-list" wx:if="{{trainingPlans.length > 0}}">
      <view class="list-header">
        <text>х╖▓ф┐ЭхнШчЪДшонч╗ГшобхИТ</text>
      </view>
      
      <view class="plan-card" wx:for="{{trainingPlans}}" wx:key="id">
        <view class="card-header">
          <view class="card-title">{{item.name}}</view>
        </view>
        
        <view class="card-content">
          <view class="card-row">
            <text class="card-label">цЧ╢щХ┐я╝Ъ</text>
            <text class="card-value">{{item.duration}} хИЖщТЯ</text>
          </view>
          <view class="card-row">
            <text class="card-label">щб╣чЫоцХ░я╝Ъ</text>
            <text class="card-value">{{item.exercises.length}} ф╕к</text>
          </view>
        </view>
        
        <view class="card-actions">
          <view class="action-btn view-btn" bindtap="viewPlanDetail" data-id="{{item.id}}">
            цЯечЬЛшпжцГЕ
          </view>
          <view class="action-btn delete-btn" bindtap="deletePlan" data-id="{{item.id}}">
            хИащЩд
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- цЙзшбМшонч╗Г Tab -->
  <view class="tab-content" wx:if="{{activeTab === 'execute'}}">
    <view class="execute-container">
      <view class="form-container">
        <view class="form-title">х╝АхзЛцЦ░шонч╗Г</view>
        
        <view class="form-item">
          <text class="label">щАЙцЛйшонч╗ГшобхИТ</text>
          <picker bindchange="selectTrainingPlan" value="{{selectedPlanIndex}}" range="{{trainingPlanNames}}" class="picker">
            <view class="picker-content">
              {{selectedPlanIndex >= 0 ? trainingPlanNames[selectedPlanIndex] : 'шп╖щАЙцЛйшонч╗ГшобхИТ'}}
              <view class="arrow">тЦ╝</view>
            </view>
          </picker>
        </view>

        <!-- шобцЧ╢хЩи -->
        <view class="timer-container" wx:if="{{selectedPlanIndex >= 0}}">
          <view class="timer">{{timerDisplay}}</view>
          <view class="timer-actions">
            <button class="timer-btn {{isTimerRunning ? 'pause-btn' : 'start-btn'}}" bindtap="toggleTimer">
              {{isTimerRunning ? 'цЪВхБЬ' : 'х╝АхзЛ'}}
            </button>
            <button class="timer-btn reset-btn" bindtap="resetTimer">щЗНч╜о</button>
          </view>
        </view>

        <!-- шонч╗ГхЖЕхо╣ -->
        <view class="training-content" wx:if="{{selectedPlanIndex >= 0}}">
          <text class="content-title">шонч╗ГхЖЕхо╣</text>
          <view class="exercise-checklist">
            <view class="exercise-check-item" wx:for="{{selectedPlan.exercises}}" wx:key="index">
              <checkbox checked="{{completedExercises[index]}}" bindtap="toggleExerciseComplete" data-index="{{index}}"></checkbox>
              <text class="exercise-name {{completedExercises[index] ? 'completed' : ''}}">{{item}}</text>
            </view>
          </view>
        </view>

        <!-- шонч╗ГхПНщжИ -->
        <view class="form-item" wx:if="{{selectedPlanIndex >= 0}}">
          <text class="label">шонч╗ГхПНщжИ</text>
          <textarea class="textarea" placeholder="шо░х╜Хф╜ачЪДшонч╗ГцДЯхПЧ..." model:value="{{trainingFeedback}}"></textarea>
        </view>

        <button class="submit-btn" bindtap="saveTrainingRecord" wx:if="{{selectedPlanIndex >= 0}}">ф┐ЭхнШшонч╗Гшо░х╜Х</button>
      </view>

      <!-- шонч╗Гшо░х╜ХхИЧшби -->
      <view class="training-records" wx:if="{{trainingRecords.length > 0}}">
        <view class="list-header">
          <text>шонч╗Гшо░х╜Х</text>
          
          <!-- цЧецЬЯщАЙцЛйхЩи -->
          <view class="date-picker">
            <picker mode="date" value="{{filterDate}}" bindchange="changeFilterDate">
              <view class="date-picker-content">
                {{filterDate || 'yyyy/mm/dd'}}
                <text class="calendar-icon">ЁЯУЕ</text>
              </view>
            </picker>
            <view class="search-btn" bindtap="searchRecords">
              <text class="search-icon">ЁЯФН</text>
            </view>
          </view>
        </view>
        
        <view class="record-card" wx:for="{{filteredRecords}}" wx:key="id">
          <view class="card-header">
            <view class="card-title">{{item.planName}}</view>
            <view class="card-date">{{item.date}}</view>
          </view>
          
          <view class="card-content">
            <view class="card-row">
              <text class="card-label">цЧ╢щХ┐я╝Ъ</text>
              <text class="card-value">{{item.duration}} хИЖщТЯ</text>
            </view>
            <view class="card-row">
              <text class="card-label">хоМцИРщб╣чЫоя╝Ъ</text>
              <text class="card-value">{{item.completedCount}}/{{item.totalCount}}</text>
            </view>
            <view class="card-feedback" wx:if="{{item.feedback}}">
              <text class="card-label">хПНщжИя╝Ъ</text>
              <text class="card-value">{{item.feedback}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- шобхИТшпжцГЕх╝╣чкЧ -->
  <view class="modal" wx:if="{{showPlanDetail}}">
    <view class="modal-content">
      <view class="modal-header">
        <text class="modal-title">{{currentPlan.name}}</text>
        <view class="close-btn" bindtap="closePlanDetail">├Ч</view>
      </view>
      
      <view class="modal-body">
        <view class="detail-item">
          <text class="detail-label">шонч╗ГцЧ╢щХ┐я╝Ъ</text>
          <text class="detail-value">{{currentPlan.duration}} хИЖщТЯ</text>
        </view>
        
        <view class="detail-item">
          <text class="detail-label">шонч╗Гщб╣чЫоя╝Ъ</text>
          <view class="detail-exercises">
            <view class="detail-exercise" wx:for="{{currentPlan.exercises}}" wx:key="index">
              <text>{{index + 1}}. {{item}}</text>
            </view>
          </view>
        </view>
      </view>
      
      <view class="modal-footer">
        <button class="modal-btn" bindtap="closePlanDetail">хЕ│щЧн</button>
      </view>
    </view>
  </view>

  <!-- ц╖╗хКач╝Цш╛Сшонч╗Гщб╣чЫочЪДх╝╣чкЧ -->
  <view class="modal" wx:if="{{showEditExercise}}">
    <view class="modal-content">
      <view class="modal-header">
        <text class="modal-title">ч╝Цш╛Сшонч╗Гщб╣чЫо</text>
        <view class="close-btn" bindtap="closeEditExercise">├Ч</view>
      </view>
      
      <view class="modal-body">
        <view class="form-item">
          <input class="input" model:value="{{editExerciseContent}}" focus="{{true}}" />
        </view>
      </view>
      
      <view class="modal-footer">
        <button class="modal-btn cancel-btn" bindtap="closeEditExercise">хПЦц╢И</button>
        <button class="modal-btn" bindtap="saveEditExercise">ф┐ЭхнШ</button>
      </view>
    </view>
  </view>
</view> 